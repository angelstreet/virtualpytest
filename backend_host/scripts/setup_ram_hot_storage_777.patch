CHANGES NEEDED FOR setup_ram_hot_storage.sh:
===============================================

1. Replace lines 122-130 with:
---
  # Fix ownership (www-data:www-data)
  sudo chown -R www-data:www-data "$HOT_PATH"
  
  # CRITICAL: ALL subdirectories need 777 for cross-service access
  # Multiple services with different users need to write/delete files:
  # - FFmpeg capture process
  # - hot_cold_archiver service
  # - capture_monitor service
  sudo chmod 777 "$HOT_PATH"
  sudo chmod 777 "$HOT_PATH/captures"
  sudo chmod 777 "$HOT_PATH/thumbnails"
  sudo chmod 777 "$HOT_PATH/segments"
  sudo chmod 777 "$HOT_PATH/metadata"
  sudo chmod 777 "$HOT_PATH/audio"
  
  echo "✓ $DEVICE hot storage ready (www-data:www-data, all dirs 777)"
---

2. Replace lines 132-148 with:
---
  # Also ensure cold storage directories exist with correct permissions (777 for cross-service access)
  COLD_CAPTURES="$BASE_PATH/$DEVICE/captures"
  COLD_SEGMENTS="$BASE_PATH/$DEVICE/segments"
  COLD_METADATA="$BASE_PATH/$DEVICE/metadata"
  COLD_AUDIO="$BASE_PATH/$DEVICE/audio"
  
  # Create all cold storage directories if they don't exist
  for COLD_DIR in "$COLD_CAPTURES" "$COLD_SEGMENTS" "$COLD_METADATA" "$COLD_AUDIO"; do
    if [ ! -d "$COLD_DIR" ]; then
      sudo mkdir -p "$COLD_DIR"
      sudo chown www-data:www-data "$COLD_DIR"
    fi
    sudo chmod 777 "$COLD_DIR"
  done
  
  # Also ensure hour folders in segments have 777 permissions
  for hour in {0..23}; do
    HOUR_DIR="$COLD_SEGMENTS/$hour"
    if [ ! -d "$HOUR_DIR" ]; then
      sudo mkdir -p "$HOUR_DIR"
      sudo chown www-data:www-data "$HOUR_DIR"
    fi
    sudo chmod 777 "$HOUR_DIR"
  done
  
  # Ensure temp directory exists for MP4 merging
  TEMP_DIR="$COLD_SEGMENTS/temp"
  if [ ! -d "$TEMP_DIR" ]; then
    sudo mkdir -p "$TEMP_DIR"
    sudo chown www-data:www-data "$TEMP_DIR"
  fi
  sudo chmod 777 "$TEMP_DIR"
  
  echo "✓ Cold storage directories ready (all 777)"
  echo ""
---

3. Replace lines 237-242 with:
---
echo "✅ RAM hot storage setup complete!"
echo "   • Devices configured: ${#DEVICES[@]} (${DEVICES[*]})"
echo "   • Each device mounted in RAM ($MOUNT_SIZE)"
echo "   • Owner: www-data:www-data"
echo "   • All subdirectories: 777 (full cross-service access)"
echo "   • Auto-mount configured in /etc/fstab"
echo "   • Will automatically remount on reboot"
---

SUMMARY:
- ALL hot storage subdirectories get 777 (captures, thumbnails, segments, metadata, audio)
- ALL cold storage subdirectories get 777 (captures, segments, metadata, audio)
- All hour folders (0-23) get 777
- Temp directory for MP4 merging gets 777

