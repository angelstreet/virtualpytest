# NOTE: This is a template file for reference only.
# The actual service file is generated by setup/local/install_host_services.sh
# with correct dynamic paths for your system.
#
# TRANSCRIPTION CONTROL:
#   By default, only audio detection runs (lightweight, critical for incidents)
#   To enable MP3 transcription (CPU-intensive Whisper), add: --transcript true
#   
#   Default (audio only):  ExecStart=.../transcript_accumulator.py
#   With transcription:    ExecStart=.../transcript_accumulator.py --transcript true

[Unit]
Description=Transcript Accumulator - Audio Detection & Transcription
After=network.target
Wants=network.target

[Service]
Type=simple
User=%USER%
Group=%USER%
WorkingDirectory=%PROJECT_ROOT%
Environment=PYTHONPATH=%PROJECT_ROOT%/shared/lib:%PROJECT_ROOT%/backend_host/src
Environment=PATH=%PROJECT_ROOT%/venv/bin:/usr/bin:/usr/local/bin
ExecStartPre=/bin/sleep 10
# Audio detection only (default - lightweight, critical for incident system)
ExecStart=%PROJECT_ROOT%/venv/bin/python backend_host/scripts/transcript_accumulator.py
# To enable transcription, add: --transcript true
# ExecStart=%PROJECT_ROOT%/venv/bin/python backend_host/scripts/transcript_accumulator.py --transcript true
Restart=always
RestartSec=10
StandardOutput=truncate:/tmp/transcript_accumulator.log
StandardError=truncate:/tmp/transcript_accumulator.log

[Install]
WantedBy=multi-user.target

